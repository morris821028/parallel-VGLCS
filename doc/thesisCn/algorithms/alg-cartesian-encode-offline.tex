\begin{algorithm*}
  \caption{Offline Type of Cartesian Tree}
  \label{alg:cartesian-encode-of}
  \begin{algorithmic}[1]
    \Require
      $A[1 \cdots s]$: storage array;
      $s$: the number of elements;
    \Ensure
      $\mathit{tid}$: this label
    \State $\langle\mathit{lsz},\mathit{lid},\mathit{value}\rangle$ $D$[$s+1$]
    \State Dp = 0
    \State $D$[0] = $\langle0,0,\infty\rangle$
    \For{$i = 1$ to $s$}
      \State v = $A$[i], lsz = 0, lid = 0
      \While{$D$[Dp].value < v}
        \State lid = tid($D$[Dp].lsz, $D$[Dp].lid, lsz, lid)
        \State lsz = lsz + $D$[Dp].lsz + 1
        \State Dp = Dp - 1
      \EndWhile
      \State Dp = Dp + 1
      \State $D$[Dp] = $\langle\mathit{lsz},\mathit{lid},\mathit{v}\rangle$
    \EndFor
    \State lsz = 0, lid = 0
    \While{Dp > 0} \Comment{pop all elements}
      \State lid = tid($D$[Dp].lsz, $D$[Dp].lid, lsz, lid)
      \State lsz = lsz + $D$[Dp].lsz + 1
      \State Dp = Dp - 1
    \EndWhile
    return lid
  \end{algorithmic}
\end{algorithm*}